// Caso em que a requisição é aceita na home
$("#requisition-<%= @friend.id %>").slideToggle();

// Caso em que a requisição é aceita no perfil do usuário
$(".secondary-sidebar .disconnect").remove();
var addFriend = "<%= escape_javascript render :partial => "friendships/form",
  :locals => { :user => current_user, :friend => @friend } %>"
$(".secondary-sidebar .actions").append(addFriend);

// Remove contato da lista de contatos do Chat
if (chat) {
  chat.unsubscribePresence("<%= @friend.presence_channel %>");
  chat.unsubscribePrivate("<%= current_user.private_channel_with(@friend) %>");
  chat.uiRemoveContact("<%= @friend.id %>");
}

<%# Remove convite da página de Convidar Amigos. %>
var $removedInvitation = $("#friendship-request-for-<%= @friend.id %>");
$removedInvitation.slideUp(150, "swing", function() {
  $removedInvitation.remove();

  var remainingInvitations = $(".sent-invitations-list").children().length;
  <%# Atualiza o contador. %>
  if (remainingInvitations > 0) {
    var $sentInvitationsCounter = $(".sent-invitations-counter");
    $sentInvitationsCounter.text(remainingInvitations);

  <%# Mostra mensagem de nenhum convite. %>
  } else {
    var $sentInvitationsArea = $(".sent-invitations-section");
    var $emptyInvitations = $('<%= escape_javascript render "empty_invitations" %>');
    $sentInvitationsArea.html($emptyInvitations);
  }

  var $systemMessage = $('<%= escape_javascript render :partial => "shared/system_message", :locals => { :message => "O convite para <strong>#{@friend.display_name}</strong> foi removido com sucesso.", :type => "success" } %>');
  $("body").append($systemMessage);
  $systemMessage.delay(3000).fadeOut(1000, "linear");
});
