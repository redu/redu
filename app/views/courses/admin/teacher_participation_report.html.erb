<%= render :partial => 'shared/management_background' %>
<div class="management-sidebar">
  <%= render :partial => 'courses/sidebar',
    :locals => { :course => @course }%>
</div>

<div class="main grid_12 omega big-col management-wrapper">
  <%= render :partial => 'courses/breadcrumbs',
    :locals => { :course => @course } %>
  <%= render :partial => 'courses/admin/header',
    :locals => { :course => @course } %>
  <div id="course-manage" class="body management">
    <%= render :partial => 'courses/admin/clean_header' %>
    <%= tabs :courses_admin do %>
      <% if @course.teachers.empty? %>
        <div class="body preview">
        <div class="flash-message notice">
          <ul class="message icons-big-before icon-privacy-lightred_64_66-before">
            <li>O conteúdo desta página não está disponível para o curso que não possui professores.</li>
            <li>Você pode continuar com as <%= link_to "configurações do curso", admin_spaces_environment_course_path(@course.environment, @course)%>.</li>
          <ul>
        </div>
        </div>
      <% else %>

        <h3 class="form-header">Qual a participação do professor na disciplina?</h3>
        <div id="teacher-participation-chart">
          <%= lazy_load(:chart, :jammit => true) do %>
            try{
            id_course = <%= @course.id %>;
            initialize_graph();
            }catch(e){}
          <% end %>
        </div>
        <%= form_tag "#", :class => "concave-form", :id => "graph-form" do %>
          <%= label_tag "", "Professor", :id => "form-problem"%>
          <%= select(:user, "id", @course.teachers.all.collect {
            |teacher| [teacher.first_name, teacher.id ] }, { :default => @course.teachers.first },
            {:class =>"concave-select"})%>

          <%= label_tag "Disciplinas" %>
          <ul class="single-column">
            <% @course.spaces.each do |space| %>
              <li>
                <%= check_box_tag "spaces-#{space.id}", space.id, true,
                { :class => "item-space-check" } %>
              <%= label_tag "spaces-#{space.id}", space.name %>
            </li>
          <% end %>
          <li>
            <%= check_box_tag "all-check", "0", true %>
            <%= label_tag "all-check", "Todos" %>
          </li>
        </ul>

        <%= label_tag "date_start", "Data inicial" %>
        <%= field_set_tag nil, :class => "inline" do %>
          <%= date_select "date_start", "start", :default => Date.today - 9 %>
        <% end %>

        <%= label_tag "date_end", "Data final" %>
        <%= field_set_tag nil, :id => "date-validate",
          :class => "inline" do %>
          <%= date_select "date_end", "start", :end_year => Date.today.year %>
        <% end %>

        <%= submit_tag "Update", :onclick => "graph_interaction();", :class=>"concave-submit" %>
      <% end %>
    <% end %>
  <% end %>
</div>
</div>
