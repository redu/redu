<tr class="course row">
  <td class="environment cell">
    <% if item.billable %>
      <% if item.billable.is_a? Environment %>
        <%= content_tag(:p, item.billable.name, :class => "name") %>
      <% else %>
        <%= item.billable.environment.name %>
        <%= content_tag(:p, item.billable.name, :class => "name") %>
      <% end %>
    <% else %>
      <span class="name"><%= item.billable_audit.try(:[], "name") || "Sem informações" %> (removido)</span>
    <% end %>
  </td>
  <td class="type-user cell">
    <%= link_to item.name, plan_invoices_path(item), :class => "name #{item.invoice.try(:overdue?) ? 'pending-user' : ''}" %>
    <% if item.pending_payment? %>
      <% if item.invoice.overdue? %>
        <p class="no-pending">Fatura em aberto, plano bloqueado</p>
      <% else %>
        <%= content_tag(:p, "Faltam #{item.invoice.threshold_date - Date.today} dias restantes", :class => "no-pending") %>
      <% end %>
    <% else %>
      <span class="no-pending">Sem pendência</span>
    <% end %>
  </td>
</tr>
